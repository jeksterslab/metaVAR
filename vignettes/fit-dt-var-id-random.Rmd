---
title: "Multivariate Meta-Analysis of Discrete-Time VAR Estimates (Random-Effects Model)"
author: Ivan Jacob Agaloos Pesigan
date: "2025-05-01"
bibliography: "vignettes.bib"
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/apa.csl
nocite: |
  @Cheung-2015
  @RCoreTeam-2024
  @Neale-Hunter-Pritikin-etal-2015
  @Hunter-2017
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Multivariate Meta-Analysis of Discrete-Time VAR Estimates (Random-Effects Model)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---







> **Note:** When the discrete-time vector autoregressive model is estimated separately for each ID,
> any of the parameters can vary across individuals.
> In this example, however, we are only varying $\boldsymbol{\alpha}$ and $\boldsymbol{\beta}$.

## Model

The measurement model is given by
\begin{equation}
  \mathbf{y}_{i, t}
  =
  \boldsymbol{\Lambda}
  \boldsymbol{\eta}_{i, t}
  +
  \boldsymbol{\varepsilon}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\varepsilon}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Theta}
  \right)
\end{equation}
where
$\mathbf{y}_{i, t}$,
$\boldsymbol{\eta}_{i, t}$,
and
$\boldsymbol{\varepsilon}_{i, t}$
are random variables
and
$\boldsymbol{\Lambda}$,
and
$\boldsymbol{\Theta}$
are model parameters.
$\mathbf{y}_{i, t}$
represents a vector of observed random variables,
$\boldsymbol{\eta}_{i, t}$
a vector of latent random variables,
and
$\boldsymbol{\varepsilon}_{i, t}$
a vector of random measurement errors,
at time $t$ and individual $i$.
$\boldsymbol{\Lambda}$
denotes a matrix of factor loadings,
and
$\boldsymbol{\Theta}$
the covariance matrix of
$\boldsymbol{\varepsilon}$.
In this model,
$\boldsymbol{\Lambda}$ is an identity matrix and
$\boldsymbol{\Theta}$ is a diagonal matrix.

The dynamic structure is given by
\begin{equation}
  \boldsymbol{\eta}_{i, t}
  =
  \boldsymbol{\alpha}_{i}
  +
  \boldsymbol{\beta}_{i}
  \boldsymbol{\eta}_{i, t - 1}
  +
  \boldsymbol{\zeta}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\zeta}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Psi}
  \right)
\end{equation}
where
$\boldsymbol{\eta}_{i, t}$,
$\boldsymbol{\eta}_{i, t - 1}$,
and
$\boldsymbol{\zeta}_{i, t}$
are random variables,
and
$\boldsymbol{\alpha}_{i}$,
$\boldsymbol{\beta}_{i}$,
and
$\boldsymbol{\Psi}$
are model parameters.
Here,
$\boldsymbol{\eta}_{i, t}$
is a vector of latent variables
at time $t$ and individual $i$,
$\boldsymbol{\eta}_{i, t - 1}$
represents a vector of latent variables
at time $t - 1$ and individual $i$,
and
$\boldsymbol{\zeta}_{i, t}$
represents a vector of dynamic noise
at time $t$ and individual $i$.
$\boldsymbol{\alpha}_{i}$
denotes a vector of intercepts
for individual $i$,
$\boldsymbol{\beta}_{i}$
a matrix of autoregression
and cross regression coefficients
for individual $i$,
and
$\boldsymbol{\Psi}$
the covariance matrix of
$\boldsymbol{\zeta}_{i, t}$.
In this model,
$\boldsymbol{\Psi}$ is a symmetric matrix.

## Data Generation

The parameters used in this example were based on @Bringmann-Vissers-Wichers-etal-2013.

### Notation

Let $t = 1000$ be the number of time points and $n = 100$ be the number of individuals.

Let the measurement model intecept vector $\boldsymbol{\nu}$ be given by

\begin{equation}
\boldsymbol{\nu}
=
\left(
\begin{array}{c}
  0 \\
  0 \\
\end{array}
\right) .
\end{equation}

Let the factor loadings matrix $\boldsymbol{\Lambda}$ be given by

\begin{equation}
\boldsymbol{\Lambda}
=
\left(
\begin{array}{cc}
  1 & 0 \\
  0 & 1 \\
\end{array}
\right) .
\end{equation}

Let the measurement error covariance matrix $\boldsymbol{\Theta}$ be given by

\begin{equation}
\boldsymbol{\Theta}
=
\left(
\begin{array}{cc}
  0.2 & 0 \\
  0 & 0.2 \\
\end{array}
\right) .
\end{equation}

Let the initial condition
$\boldsymbol{\eta}_{0}$
be given by

\begin{equation}
\boldsymbol{\eta}_{0} \sim \mathcal{N} \left( \boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}, \boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0} \right)
\end{equation}

\begin{equation}
\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}
=
\left(
\begin{array}{c}
  3.8143546 \\
  2.5763481 \\
\end{array}
\right)
\end{equation}

\begin{equation}
\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}
=
\left(
\begin{array}{cc}
  1.3978842 & 0.5782369 \\
  0.5782369 & 1.6636513 \\
\end{array}
\right) .
\end{equation}

Let the intercept vector $\boldsymbol{\alpha}$ be normally distributed with the following means

\begin{equation}
\left(
\begin{array}{c}
  2.87 \\
  2.04 \\
\end{array}
\right)
\end{equation}

and covariance matrix

\begin{equation}
\left(
\begin{array}{cc}
  1.2 & 0.459565 \\
  0.459565 & 1.1 \\
\end{array}
\right) .
\end{equation}

Let the transition matrix $\boldsymbol{\beta}$ be normally distributed with the following means

\begin{equation}
\left(
\begin{array}{cc}
  0.28 & -0.048 \\
  -0.035 & 0.26 \\
\end{array}
\right)
\end{equation}

and covariance matrix

\begin{equation}
\left(
\begin{array}{cccc}
  0.0169 & 0.00468 & 0.001456 & 0.00832 \\
  0.00468 & 0.0081 & 0.001008 & 0.00576 \\
  0.001456 & 0.001008 & 0.000784 & 0.001792 \\
  0.00832 & 0.00576 & 0.001792 & 0.0256 \\
\end{array}
\right) .
\end{equation}

The `SimAlphaN` and `SimBetaN` functions from the `simStateSpace` package generates random intercept vectors and transition matrices from the multivariate normal distribution. Note that the `SimBetaN` function generates transition matrices that are weakly stationary.

Let the dynamic process noise $\boldsymbol{\Psi}$ be given by

\begin{equation}
\boldsymbol{\Psi}
=
\left(
\begin{array}{cc}
  1.3 & 0.5696315 \\
  0.5696315 & 1.56 \\
\end{array}
\right) .
\end{equation}



### R Function Arguments


``` r
n
#> [1] 100
time
#> [1] 1000
mu0
#> [[1]]
#> [1] 3.814355 2.576348
sigma0
#>           [,1]      [,2]
#> [1,] 1.3978842 0.5782369
#> [2,] 0.5782369 1.6636513
sigma0_l
#> [[1]]
#>           [,1]     [,2]
#> [1,] 1.1823215 0.000000
#> [2,] 0.4890691 1.193509
# first alpha in the list of length n
alpha[[1]]
#> [1] 0.8481424 2.1983711
# first beta in the list of length n
beta[[1]]
#>            [,1]       [,2]
#> [1,] 0.21090478 0.00660174
#> [2,] 0.01360809 0.37057228
psi
#>           [,1]      [,2]
#> [1,] 1.3000000 0.5696315
#> [2,] 0.5696315 1.5600000
psi_l
#> [[1]]
#>           [,1]     [,2]
#> [1,] 1.1401754 0.000000
#> [2,] 0.4995998 1.144727
nu
#> [[1]]
#> [1] 0 0
lambda
#> [[1]]
#>      [,1] [,2]
#> [1,]    1    0
#> [2,]    0    1
theta
#>      [,1] [,2]
#> [1,]  0.2  0.0
#> [2,]  0.0  0.2
```

### Visualizing the Dynamics Without Process Noise (n = 5 with Different Initial Condition)

<img src="fig-vignettes-fit-dt-var-id-mx-random-no-error-1.png" width="3300" /><img src="fig-vignettes-fit-dt-var-id-mx-random-no-error-2.png" width="3300" />

### Using the `SimSSMIVary` Function from the `simStateSpace` Package to Simulate Data


``` r
library(simStateSpace)
sim <- SimSSMIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l
)
data <- as.data.frame(sim)
head(data)
#>   id time         y1       y2
#> 1  1    0  4.2923877 3.340872
#> 2  1    1  1.0083994 5.277654
#> 3  1    2  0.1329195 3.635821
#> 4  1    3 -0.5846274 3.113339
#> 5  1    4 -0.6400584 3.361309
#> 6  1    5  1.9021483 4.217966
plot(sim)
```

<img src="fig-vignettes-fit-dt-var-id-mx-random-error-1.png" width="3300" /><img src="fig-vignettes-fit-dt-var-id-mx-random-error-2.png" width="3300" />

## Model Fitting

The `DTVAR` function fits a DT-VAR model on each individual $i$ using the `byid = TRUE` argument.
The model type is specified using the `model` argument.




``` r
library(fitDTVARMx)
fit <- DTVAR(
  data = data,
  observed = paste0("y", seq_len(k)),
  id = "id",
  model = 5,
  byid = TRUE,
  ncores = parallel::detectCores()
)
fit
#>  paramaters per individual.
#>            beta_11      beta_21      beta_12     beta_22     alpha_1
#>   [1,] -0.85947202 -0.012039283  0.434889876  0.36735476  0.47422602
#>   [2,]  0.26747476 -0.059060437  0.002093427  0.49047935  4.26029873
#>   [3,]  0.35629928  0.035702733 -0.038112320  0.37052714  2.28917684
#>   [4,]  0.23362144 -0.018121573 -0.111949908  0.64425424  3.81489295
#>   [5,]  0.25064738 -0.108838771 -0.063033734  0.33984007  3.72374586
#>   [6,] -0.36511967 -0.019155111  0.183874623  0.42571408  4.48652081
#>   [7,] -0.22775240 -0.087172279  0.119549774  0.43282090  3.51298982
#>   [8,] -0.05513484 -0.283072525 -0.093020931  0.24247882  3.23487616
#>   [9,]  0.44748821 -0.044627969 -0.063223146  0.43703848  2.69334343
#>  [10,]  0.12109333 -0.317562695 -0.075898969  0.31548924  3.24493909
#>  [11,]  0.25645603 -0.055748428 -0.023033995  0.21344898  4.08297077
#>  [12,]  0.41733201  0.415840643  0.107619360 -0.48104553  1.72934818
#>  [13,] -0.06441210  0.179028226  0.440803459  0.11551135  3.69070206
#>  [14,]  0.08115127 -0.110517765 -0.104601444  0.28607946  3.38149768
#>  [15,]  0.31768029 -0.189503339 -0.123262444  0.49286211  3.35619507
#>  [16,] -0.48744881 -0.084122585  0.187381706  0.37529271  5.24647407
#>  [17,] -1.15790596 -0.518976174  3.429764928  1.46844378  1.99327435
#>  [18,]  0.23868229  0.232738943  0.004730939 -0.53061437  4.02993146
#>  [19,]  0.48219825  0.341100015  0.030405436 -0.45312836  2.67847827
#>  [20,]  0.05642129 -0.504269676 -0.001201591  0.36356550  3.62403012
#>  [21,]  0.30501244 -0.063076132 -0.039522058  0.43654694  1.50648738
#>  [22,] -0.58545513 -0.239373147  0.410805310  0.78852780 10.56978795
#>  [23,]  0.30024289  0.102794060 -0.042459356  0.11650886  2.77325242
#>  [24,]  0.52891003  0.182397326 -0.009206871  0.37841175  4.22817897
#>  [25,] -0.40330082  0.009710887  0.202390908  0.39944792  1.54066345
#>  [26,]  0.48593872 -0.043068226 -0.022951677  0.45626082  1.86222070
#>  [27,]  0.39733887  0.079977438 -0.042258967  0.55021183  2.63426977
#>  [28,]  0.38339238  0.402546057  0.006469965 -0.46655966  4.04938296
#>  [29,]  0.52347332 -0.037825817 -0.004383104  0.32534299  2.83120308
#>  [30,]  0.32892122  0.054408189 -0.089147662  0.42650082  2.47404080
#>  [31,]  0.31886830 -0.081924995  0.062691420  0.30686921  3.01633783
#>  [32,]  0.32976266 -0.175524804 -0.117156104 -0.13163366  3.82597286
#>  [33,]  0.40719047 -0.163904346 -0.070585596  0.37051147  3.97997740
#>  [34,] -0.26185080 -0.358025790  0.179980189  0.25617053  3.76218202
#>  [35,]  0.44270710  0.068575578 -0.046388656  0.40877036  0.08393501
#>  [36,] -0.26549874  0.891814687  0.106840267 -0.06709486 -0.34239129
#>  [37,]  0.36800472 -0.073496415 -0.117703775  0.18003091  3.42102608
#>  [38,] -0.51445530  0.058118126  0.333726603  0.33928646  4.70655855
#>  [39,]  0.33624131 -0.014780858 -0.001962437  0.37077835  3.02349007
#>  [40,] -0.36576382  0.296468669  0.136779112  0.02236359  1.96303829
#>  [41,]  0.13507268 -0.086350167 -0.047291854  0.43210404  2.10504962
#>  [42,] -0.47628146 -0.035744870  0.203431610  0.32919445  2.90459446
#>  [43,]  0.41694732 -0.142837761 -0.135422514  0.40909447  1.14388258
#>  [44,]  0.26024309  0.158142281 -0.014289358 -0.51695114  4.79967348
#>  [45,]  0.20686903  0.027817284 -0.099460995  0.03424789  2.08529588
#>  [46,]  0.14458255 -0.144050063  0.062758651  0.01829476  2.18216042
#>  [47,]  0.17064150  0.135796611 -0.013720677 -0.22566524  3.68578163
#>  [48,] -0.54980850 -0.137886901  0.163030713  0.31883901  3.15976155
#>  [49,]  0.26181890 -0.160762025 -0.172230118  0.23762861  3.54742517
#>  [50,]  0.20283765 -0.101614488 -0.074407294  0.44687554  2.44842228
#>  [51,]  0.20941324 -0.164575202  0.093660426  0.47899626  3.05619201
#>  [52,]  0.26906304 -0.175799585 -0.077956536  0.31125898  3.31855210
#>  [53,]  0.23778521  0.157106732 -0.205129317 -0.42529102  2.78746935
#>  [54,]  0.20543198  0.112256503  0.217610619 -0.25461847  3.72278759
#>  [55,]  0.27140851 -0.418553775 -0.052127066  0.15915746  4.80886191
#>  [56,]  0.22767886 -0.186896229 -0.073326246  0.16086751  2.81334350
#>  [57,]  0.26699908 -0.094400501 -0.095047442  0.23646179  2.55558516
#>  [58,] -0.16976597 -1.439399438  0.054452511  0.69499979  3.58171074
#>  [59,]  0.52141338 -0.061236821 -0.187748030  0.31109066  2.46541690
#>  [60,]  0.40837259  0.002048879 -0.612145481  0.04969331  2.90558757
#>  [61,]  0.26280168 -0.242125000 -0.220932798 -0.01742405  3.99100477
#>  [62,] -1.22385434 -0.428433623  3.600947552  1.29779934  2.68623267
#>  [63,]  0.14423558 -0.107973584 -0.063785576  0.44924603  2.86292699
#>  [64,]  0.12403212  0.004944022  0.001596223  0.48017765  2.30154955
#>  [65,] -0.24991167  0.288326902  0.261678202  0.12322319  2.57302698
#>  [66,]  0.36025755 -0.071491523 -0.069816044  0.06123023  1.19973658
#>  [67,]  0.29769126 -0.092040783 -0.002074986  0.11617225  2.59956028
#>  [68,] -0.46356005 -0.058444988  0.248699985  0.46707428  2.63025033
#>  [69,]  0.51521112  0.545211591  0.146742453 -0.53882746  3.68972657
#>  [70,]  0.20110290 -0.273352840 -0.015699472  0.33552623  3.37524988
#>  [71,] -0.46875220 -0.075229125  0.519035592  0.66148197  5.16409452
#>  [72,]  0.18935165 -0.156446969 -0.110502489  0.13064781  2.95109510
#>  [73,]  0.38565128 -0.091259945 -0.082359891  0.19667215  3.50172477
#>  [74,]  0.59533228 -0.028477390 -0.021770517  0.18629019  4.65360696
#>  [75,]  0.35623221  0.145214837 -0.027240409  0.32077861  1.92207620
#>  [76,]  0.30065793 -0.134928765 -0.034415833  0.27208156  4.57108324
#>  [77,]  0.22991724 -0.127730061 -0.033033143  0.28816612  2.00865673
#>  [78,]  0.49501931  0.234990486 -0.097351169 -0.49981133  1.00319115
#>  [79,]  0.16572238 -0.044307158 -0.106232023  0.33940371  2.18065392
#>  [80,] -0.53099147 -0.053461029  0.290870945  0.39529667  6.09911474
#>  [81,]  0.19810387 -0.115402910 -0.104751539  0.12968958  2.07929561
#>  [82,]  0.27017718 -0.131426504 -0.332525162 -0.05532521  2.99518600
#>  [83,]  0.51242714  0.038648142 -0.007383216  0.84373803  1.63439493
#>  [84,]  0.29900180 -0.069606071 -0.061749950 -0.02777781  1.74008370
#>  [85,]  0.13711310 -0.032408616  0.012832564  0.29046932  2.09622961
#>  [86,]  0.21593520 -0.029299385 -0.074454308  0.27494343  0.63514011
#>  [87,] -0.42817568  0.053253747  0.325345195  0.26760104  1.12695737
#>  [88,]  0.15591356 -0.420268517 -0.026449806  0.27918492  2.57524614
#>  [89,]  0.21839225 -0.312486017 -0.084933690  0.22713881  1.92508604
#>  [90,]  0.18169675 -0.080038313 -0.096445850  0.18411952  1.73758266
#>  [91,] -0.49483199  0.141867178  0.231870198  0.20100273  4.77862571
#>  [92,]  0.20822005 -0.420509520 -0.064791322  0.17309780  3.41848796
#>  [93,]  0.16750988  0.034628006 -0.081072830  0.23286861  3.02253406
#>  [94,]  0.50979289 -0.048452987 -0.045534657  0.33977607  3.26079985
#>  [95,]  0.38815275  0.476292427 -0.007807346 -0.52508931  3.25226109
#>  [96,]  0.17529171 -0.147459557  0.022371694  0.09043369  2.89326134
#>  [97,]  0.26100465 -0.072521671 -0.026934798  0.47319918  2.36752548
#>  [98,]  0.26535530 -0.075956408 -0.056603361  0.15803546  2.33032786
#>  [99,]  0.17614036 -0.094232800 -0.085205252  0.23181216  3.14905471
#> [100,]  0.23964452 -0.146178092  0.010911675  0.09804725  4.33027294
#>            alpha_2        psi_11    psi_21        psi_22      theta_11
#>   [1,]  2.26866995  1.534180e-01 0.5192412  1.561854e+00  1.443110e+00
#>   [2,]  3.59253854  1.456062e+00 0.4782968  1.678530e+00 2.225074e-308
#>   [3,]  0.43691307  7.741899e-01 0.5468848  1.531423e+00  6.266520e-01
#>   [4,]  1.86199367  1.447022e+00 0.5467411  1.368753e+00  7.579624e-02
#>   [5,]  3.11765081  1.011366e+00 0.6305239  1.748665e+00  5.075117e-01
#>   [6,]  1.45360916  2.145529e-17 0.6660325  1.678225e+00  1.570653e+00
#>   [7,]  2.08398734  4.248909e-17 0.5482582  1.106829e+00  1.423940e+00
#>   [8,]  0.89031333  1.541239e+00 0.5766485  1.055400e+00 2.225074e-308
#>   [9,]  1.08140759  1.179349e+00 0.6033275  1.263951e+00  3.907030e-01
#>  [10,]  4.06570805  8.347573e-01 0.5665074  1.530112e+00  5.671402e-01
#>  [11,]  1.04835562  1.528654e+00 0.5277816  1.615504e+00 2.225074e-308
#>  [12,] -0.19458632  1.328638e+00 0.5975770  2.642969e-20  1.663255e-01
#>  [13,]  0.80122159 2.225074e-308 0.5867381  3.942635e-01  1.565969e+00
#>  [14,]  1.93052282  1.594238e+00 0.5126009  1.047730e+00 2.225074e-308
#>  [15,]  2.14194966  1.278927e+00 0.5702377  2.953559e-01  2.188904e-01
#>  [16,]  1.94336808  1.228450e-18 0.5863629  1.807574e+00  1.514275e+00
#>  [17,]  0.69380442  1.739830e+00 0.6874664  2.537968e-01  1.929597e-17
#>  [18,]  1.83912831  1.567855e+00 0.6271089 2.225074e-308 2.225074e-308
#>  [19,]  5.66479926  1.218698e+00 0.6281738  3.634680e-18  3.506584e-01
#>  [20,]  2.58861969  4.534518e-01 0.5461181  1.573505e+00  1.037483e+00
#>  [21,]  1.98509468  1.331270e+00 0.4834306  1.485070e+00  2.012220e-01
#>  [22,]  5.44015648  6.748112e-15 0.8127246  2.077655e+00  1.898385e+00
#>  [23,]  2.05366278  1.645266e+00 0.6356734  1.769637e+00 2.225074e-308
#>  [24,]  3.67999519  1.150630e+00 0.5260285  1.427302e+00  2.995563e-01
#>  [25,]  1.13568443 2.225074e-308 0.6171610  1.216551e+00  1.627502e+00
#>  [26,]  3.23083865  7.115583e-01 0.5601364  1.323402e+00  7.315931e-01
#>  [27,]  2.83679315  1.481329e+00 0.4859776  1.383985e+00  1.097445e-17
#>  [28,]  2.63926014  1.210578e+00 0.5333779  4.413114e-18  2.307873e-01
#>  [29,]  0.01949861  9.490372e-01 0.4743996  1.532927e+00  4.372862e-01
#>  [30,]  1.70545412  1.263997e+00 0.5802375  1.361932e+00  1.851205e-01
#>  [31,]  0.58601487  1.209262e+00 0.4980185  1.142605e+00  1.854463e-01
#>  [32,]  1.99808910  1.131245e+00 0.5887397  1.329087e+00  3.169804e-01
#>  [33,]  0.94956336  7.135443e-01 0.5712682  1.072394e+00  6.678274e-01
#>  [34,]  1.85953915  1.301065e+00 0.6909727  9.412174e-18  2.344886e-01
#>  [35,]  2.21669414  1.315835e+00 0.5050339  1.384559e+00  3.262404e-01
#>  [36,]  5.14934868  2.962926e-25 0.4681338  1.881202e+00  1.608609e+00
#>  [37,]  1.53849376  6.039547e-01 0.5118838  1.787186e+00  8.446591e-01
#>  [38,]  1.32357155  1.177274e-17 0.5541911  1.454124e+00  1.746434e+00
#>  [39,]  0.06453525  1.236621e+00 0.5249093  1.361685e+00  3.225829e-01
#>  [40,]  4.09338175  1.167974e-18 0.6146515  1.867674e+00  1.638083e+00
#>  [41,]  2.42209802  1.481385e+00 0.5683684  1.729104e+00 2.225074e-308
#>  [42,]  2.27060941  2.888412e-16 0.6431477  1.889334e+00  1.557683e+00
#>  [43,]  0.83176140  1.539731e+00 0.5680510  1.075286e+00 2.225074e-308
#>  [44,]  2.54771566  1.481781e+00 0.5855602 2.225074e-308  2.711197e-16
#>  [45,]  0.65942811  1.375787e+00 0.4979665  1.730234e+00  2.753549e-18
#>  [46,]  0.99282445  1.519311e+00 0.5318764  3.911419e-17  1.971948e-22
#>  [47,]  4.77015211  1.338394e+00 0.6200947 2.225074e-308  1.576684e-01
#>  [48,]  1.91647014 2.225074e-308 0.5866686  1.769775e+00  1.548363e+00
#>  [49,]  2.67789054  1.111213e+00 0.5776334  1.599381e+00  3.671350e-01
#>  [50,]  1.40261817  5.276514e-01 0.5299679  1.711947e+00  8.200095e-01
#>  [51,]  2.95267870  1.507466e+00 0.5217900  1.140306e+00  8.301070e-17
#>  [52,]  3.67459206  1.579173e+00 0.5754444  9.116353e-01  9.645006e-19
#>  [53,] -0.88967285  1.505748e+00 0.6055787 2.225074e-308  8.517861e-10
#>  [54,]  2.93305382  1.512455e+00 0.5646697  6.518360e-17  1.997087e-17
#>  [55,]  1.51823421  8.307865e-01 0.6526764  1.752731e+00  7.414750e-01
#>  [56,]  1.99800047  1.192672e+00 0.4979633  1.704362e+00  2.603650e-01
#>  [57,]  0.16886990  1.312853e+00 0.5381003  1.762789e+00  1.650092e-01
#>  [58,]  5.10325741  3.772325e-01 0.5300451  7.966065e-01  1.129964e+00
#>  [59,]  2.27016369  1.330924e+00 0.5398654  1.114226e-17  1.676738e-01
#>  [60,]  2.26320120  1.437059e+00 0.6136604  4.111302e-01 2.225074e-308
#>  [61,]  1.23917633  1.117894e+00 0.5943774  8.097660e-01  3.666220e-01
#>  [62,]  1.19510843  1.830144e+00 0.6763006  2.144720e-01  8.839890e-18
#>  [63,]  2.79708801  1.508968e+00 0.5385719  8.564258e-01  8.256212e-18
#>  [64,]  1.52458097  1.447233e+00 0.5158323  1.193980e+00  1.746354e-17
#>  [65,]  0.14731197  7.205062e-19 0.5550512  8.445298e-01  1.686857e+00
#>  [66,]  0.43059705  1.327149e+00 0.5330161  1.691795e+00  2.142272e-01
#>  [67,]  3.20675189  1.493956e+00 0.6220944  1.789142e+00 2.225074e-308
#>  [68,]  3.05770249 2.225074e-308 0.7764666  1.973620e+00  1.701291e+00
#>  [69,]  3.34557892  9.881726e-01 0.4941456 2.225074e-308  4.909821e-01
#>  [70,]  1.05737082  1.392339e+00 0.5533862  1.755644e+00 2.225074e-308
#>  [71,]  2.32172983 2.225074e-308 0.8207552  1.169148e+00  2.059366e+00
#>  [72,]  2.52919137  1.562583e+00 0.6606053  9.057239e-01  9.783608e-19
#>  [73,]  2.49072019  1.001467e+00 0.4368845  1.707569e+00  4.208965e-01
#>  [74,]  2.77230928  1.378622e+00 0.5441447  1.479452e+00  1.409762e-01
#>  [75,]  2.30369087  1.333986e+00 0.5567779  1.747347e+00  9.969053e-02
#>  [76,]  3.54159609  1.516331e+00 0.5149255  1.852622e+00  6.345072e-17
#>  [77,]  1.08914360  1.586199e+00 0.6041377  1.379945e+00  9.073992e-20
#>  [78,]  3.66930075  1.655677e+00 0.6940802  1.993169e-15  1.504514e-15
#>  [79,]  2.85135098  1.119484e+00 0.6581339  1.204231e+00  3.614876e-01
#>  [80,]  2.82072170  4.584507e-13 0.5736857  1.329864e+00  1.749358e+00
#>  [81,]  0.37680334  1.516197e+00 0.5481506  1.697125e+00 2.225074e-308
#>  [82,]  2.21514012  1.473909e+00 0.5342306  5.122590e-01 2.225074e-308
#>  [83,]  1.75965832  1.320376e+00 0.5619191  1.328986e+00  1.290584e-01
#>  [84,]  1.21850224  1.130679e+00 0.6169321  1.764002e+00  3.229148e-01
#>  [85,]  2.64809941  1.511100e+00 0.5641618  1.657058e+00 2.225074e-308
#>  [86,]  0.32578753  1.544059e+00 0.6250222  1.518975e+00 2.225074e-308
#>  [87,]  3.01999137 2.225074e-308 0.5123161  7.900725e-01  1.645256e+00
#>  [88,]  2.95913594  9.586578e-01 0.6048904  1.746725e+00  5.573513e-01
#>  [89,]  1.96045038  9.519908e-01 0.6726958  1.830432e+00  5.589507e-01
#>  [90,]  2.88642347  1.571741e+00 0.6063614  1.770887e+00  3.042863e-18
#>  [91,]  2.48575047  2.322894e-15 0.5815963  1.702257e+00  1.695056e+00
#>  [92,]  2.84927746  1.167911e+00 0.5723045  1.720708e+00  3.332942e-01
#>  [93,]  2.61169778  1.639400e+00 0.7340346  1.916738e+00  1.459248e-16
#>  [94,]  2.30587112  1.117097e+00 0.5837506  1.356725e+00  3.428644e-01
#>  [95,]  1.71101867  9.026432e-01 0.5512027 2.225074e-308  4.790705e-01
#>  [96,]  1.63403995  1.604533e+00 0.6299923  1.712179e+00  2.738550e-16
#>  [97,]  0.66665955  1.203202e+00 0.4442784  1.148930e+00  1.853462e-01
#>  [98,]  1.35789841  1.517375e+00 0.5801312  1.738695e+00 2.225074e-308
#>  [99,]  1.16037917  1.577041e+00 0.6774147  9.999102e-01 2.225074e-308
#> [100,]  3.33426115  1.438777e+00 0.5523081  1.729334e+00  3.343966e-18
#>             theta_22
#>   [1,]  1.633482e-01
#>   [2,]  3.920186e-02
#>   [3,]  2.556730e-01
#>   [4,]  2.362818e-01
#>   [5,] 2.225074e-308
#>   [6,]  1.063163e-01
#>   [7,]  5.215146e-01
#>   [8,]  6.741425e-01
#>   [9,]  4.577077e-01
#>  [10,] 2.225074e-308
#>  [11,]  1.025779e-01
#>  [12,]  2.042394e+00
#>  [13,]  1.337566e+00
#>  [14,]  5.342184e-01
#>  [15,]  1.307771e+00
#>  [16,] 2.225074e-308
#>  [17,]  1.654757e+00
#>  [18,]  1.928396e+00
#>  [19,]  1.972160e+00
#>  [20,]  3.313737e-18
#>  [21,]  1.078109e-01
#>  [22,]  3.684039e-03
#>  [23,] 2.225074e-308
#>  [24,]  2.677117e-01
#>  [25,]  5.957937e-01
#>  [26,]  3.956066e-01
#>  [27,]  2.491663e-01
#>  [28,]  1.911298e+00
#>  [29,]  1.599745e-01
#>  [30,]  5.168964e-01
#>  [31,]  6.373842e-01
#>  [32,]  4.085835e-01
#>  [33,]  5.611975e-01
#>  [34,]  1.766564e+00
#>  [35,]  2.581236e-01
#>  [36,]  7.705681e-18
#>  [37,] 2.225074e-308
#>  [38,]  3.773249e-01
#>  [39,]  3.096458e-01
#>  [40,] 2.225074e-308
#>  [41,]  2.737801e-17
#>  [42,]  3.654289e-16
#>  [43,]  5.306753e-01
#>  [44,]  1.892426e+00
#>  [45,] 2.225074e-308
#>  [46,]  1.733210e+00
#>  [47,]  1.764097e+00
#>  [48,]  1.191009e-16
#>  [49,]  1.451061e-01
#>  [50,] 2.225074e-308
#>  [51,]  6.223234e-01
#>  [52,]  7.617780e-01
#>  [53,]  1.794664e+00
#>  [54,]  1.835591e+00
#>  [55,] 2.225074e-308
#>  [56,]  2.865167e-03
#>  [57,]  9.192619e-18
#>  [58,]  7.867074e-01
#>  [59,]  1.842880e+00
#>  [60,]  1.286114e+00
#>  [61,]  9.444839e-01
#>  [62,]  1.511763e+00
#>  [63,]  8.015826e-01
#>  [64,]  4.815890e-01
#>  [65,]  9.761668e-01
#>  [66,] 2.225074e-308
#>  [67,]  7.321615e-30
#>  [68,] 2.225074e-308
#>  [69,]  2.077915e+00
#>  [70,]  3.699162e-03
#>  [71,]  6.004832e-01
#>  [72,]  8.219510e-01
#>  [73,] 2.225074e-308
#>  [74,]  2.108904e-01
#>  [75,]  4.640232e-02
#>  [76,] 2.225074e-308
#>  [77,]  4.049936e-01
#>  [78,]  1.993383e+00
#>  [79,]  5.460556e-01
#>  [80,]  4.989263e-01
#>  [81,]  5.335475e-18
#>  [82,]  1.257354e+00
#>  [83,]  3.671493e-01
#>  [84,]  8.620644e-17
#>  [85,] 2.225074e-308
#>  [86,]  3.027064e-01
#>  [87,]  8.810915e-01
#>  [88,] 2.225074e-308
#>  [89,]  4.010625e-18
#>  [90,]  8.191181e-17
#>  [91,] 2.225074e-308
#>  [92,] 2.225074e-308
#>  [93,]  2.224308e-17
#>  [94,]  3.999587e-01
#>  [95,]  2.085391e+00
#>  [96,] 2.225074e-308
#>  [97,]  4.965539e-01
#>  [98,]  1.962868e-17
#>  [99,]  7.117343e-01
#> [100,] 2.225074e-308
```

## Multivariate Meta-Analysis

The `MetaVARMx` function performs multivariate meta-analysis using the estimated parameters
and the corresponding sampling variance-covariance matrix for each individual $i$.
Estimates with the prefix `b0` correspond to the estimates of `beta_mu` and `alpha_mu`.
Estimates with the prefix `t2` correspond to the estimates of `beta_sigma` and `alpha_sigma`.
Estimates with the prefix `i2` correspond to the estimates of heterogeniety.


``` r
library(metaVAR)
meta <- MetaVARMx(
  object = fit,
  random = FALSE,
  intercept = TRUE,
  ncores = parallel::detectCores()
)
#> Running Model with 6 parameters
#> 
#> Beginning initial fit attempt
#> Running Model with 6 parameters
#> 
#>  Lowest minimum so far:  39286.2844015593
#> 
#> Solution found
```



```
#> 
#>  Solution found!  Final fit=39286.284 (started at 1876386.5)  (1 attempt(s): 1 valid, 0 errors)
#>  Start values from best fit:
#> 0.899537487099718,-0.0569520856848798,-0.0488084241440097,0.939213185820158,0.519092812567682,0.358673358569195
summary(meta)
#>          est     se        z p    2.5%   97.5%
#> b0_1  0.8995 0.0019 464.5540 0  0.8957  0.9033
#> b0_2 -0.0570 0.0019 -30.0599 0 -0.0607 -0.0532
#> b0_3 -0.0488 0.0016 -30.3017 0 -0.0520 -0.0457
#> b0_4  0.9392 0.0016 573.0759 0  0.9360  0.9424
#> b0_5  0.5191 0.0087  59.3694 0  0.5020  0.5362
#> b0_6  0.3587 0.0075  47.5320 0  0.3439  0.3735
```

## References


