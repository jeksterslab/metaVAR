---
title: "Multivariate Meta-Analysis of Discrete-Time VAR Estimates (Mixed-Effects Model)"
author: Ivan Jacob Agaloos Pesigan
date: "2025-05-01"
bibliography: "vignettes.bib"
csl: https://raw.githubusercontent.com/citation-style-language/styles/master/apa.csl
nocite: |
  @Cheung-2015
  @RCoreTeam-2024
  @Neale-Hunter-Pritikin-etal-2015
  @Hunter-2017
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Multivariate Meta-Analysis of Discrete-Time VAR Estimates (Mixed-Effects Model)}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---







> **Note:** When the discrete-time vector autoregressive model is estimated separately for each ID,
> any of the parameters can vary across individuals.

## Model

The measurement model is given by
\begin{equation}
  \mathbf{y}_{i, t}
  =
  \boldsymbol{\Lambda}
  \boldsymbol{\eta}_{i, t}
  +
  \boldsymbol{\varepsilon}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\varepsilon}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Theta}
  \right)
\end{equation}
where
$\mathbf{y}_{i, t}$,
$\boldsymbol{\eta}_{i, t}$,
and
$\boldsymbol{\varepsilon}_{i, t}$
are random variables
and
$\boldsymbol{\Lambda}$,
and
$\boldsymbol{\Theta}$
are model parameters.
$\mathbf{y}_{i, t}$
represents a vector of observed random variables,
$\boldsymbol{\eta}_{i, t}$
a vector of latent random variables,
and
$\boldsymbol{\varepsilon}_{i, t}$
a vector of random measurement errors,
at time $t$ and individual $i$.
$\boldsymbol{\Lambda}$
denotes a matrix of factor loadings,
and
$\boldsymbol{\Theta}$
the covariance matrix of
$\boldsymbol{\varepsilon}$.
In this model,
$\boldsymbol{\Lambda}$ is an identity matrix and
$\boldsymbol{\Theta}$ is a diagonal matrix.

The dynamic structure is given by
\begin{equation}
  \boldsymbol{\eta}_{i, t}
  =
  \boldsymbol{\alpha}_{i}
  +
  \boldsymbol{\beta}_{i}
  \boldsymbol{\eta}_{i, t - 1}
  +
  \boldsymbol{\zeta}_{i, t},
  \quad
  \mathrm{with}
  \quad
  \boldsymbol{\zeta}_{i, t}
  \sim
  \mathcal{N}
  \left(
  \mathbf{0},
  \boldsymbol{\Psi}
  \right)
\end{equation}
where
$\boldsymbol{\eta}_{i, t}$,
$\boldsymbol{\eta}_{i, t - 1}$,
and
$\boldsymbol{\zeta}_{i, t}$
are random variables,
and
$\boldsymbol{\alpha}_{i}$,
$\boldsymbol{\beta}_{i}$,
and
$\boldsymbol{\Psi}$
are model parameters.
Here,
$\boldsymbol{\eta}_{i, t}$
is a vector of latent variables
at time $t$ and individual $i$,
$\boldsymbol{\eta}_{i, t - 1}$
represents a vector of latent variables
at time $t - 1$ and individual $i$,
and
$\boldsymbol{\zeta}_{i, t}$
represents a vector of dynamic noise
at time $t$ and individual $i$.
$\boldsymbol{\alpha}_{i}$
denotes a vector of intercepts
for individual $i$,
$\boldsymbol{\beta}_{i}$
a matrix of autoregression
and cross regression coefficients
for individual $i$,
and
$\boldsymbol{\Psi}$
the covariance matrix of
$\boldsymbol{\zeta}_{i, t}$.
In this model,
$\boldsymbol{\Psi}$ is a symmetric matrix.

## Data Generation

The parameters used in this example were based on @Bringmann-Vissers-Wichers-etal-2013.

### Notation

Let $t = 1000$ be the number of time points and $n = 100$ be the number of individuals.

Let the measurement model intecept vector $\boldsymbol{\nu}$ be given by

\begin{equation}
\boldsymbol{\nu}
=
\left(
\begin{array}{c}
  0 \\
  0 \\
\end{array}
\right) .
\end{equation}

Let the factor loadings matrix $\boldsymbol{\Lambda}$ be given by

\begin{equation}
\boldsymbol{\Lambda}
=
\left(
\begin{array}{cc}
  1 & 0 \\
  0 & 1 \\
\end{array}
\right) .
\end{equation}

Let the measurement error covariance matrix $\boldsymbol{\Theta}$ be given by

\begin{equation}
\boldsymbol{\Theta}
=
\left(
\begin{array}{cc}
  0.2 & 0 \\
  0 & 0.2 \\
\end{array}
\right) .
\end{equation}

Let the initial condition
$\boldsymbol{\eta}_{0}$
be given by

\begin{equation}
\boldsymbol{\eta}_{0} \sim \mathcal{N} \left( \boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}, \boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0} \right)
\end{equation}

\begin{equation}
\boldsymbol{\mu}_{\boldsymbol{\eta} \mid 0}
=
\left(
\begin{array}{c}
  3.8143546 \\
  2.5763481 \\
\end{array}
\right)
\end{equation}

\begin{equation}
\boldsymbol{\Sigma}_{\boldsymbol{\eta} \mid 0}
=
\left(
\begin{array}{cc}
  1.3978842 & 0.5782369 \\
  0.5782369 & 1.6636513 \\
\end{array}
\right) .
\end{equation}

Let the intercept vector $\boldsymbol{\alpha}$ be normally distributed with the following means

\begin{equation}
\left(
\begin{array}{c}
  2.87 \\
  2.04 \\
\end{array}
\right)
\end{equation}

and covariance matrix

\begin{equation}
\left(
\begin{array}{cc}
  1.2 & 0.459565 \\
  0.459565 & 1.1 \\
\end{array}
\right) .
\end{equation}

Let the transition matrix $\boldsymbol{\beta}$ be normally distributed with the following means

\begin{equation}
\left(
\begin{array}{cc}
  0.28 & -0.048 \\
  -0.035 & 0.26 \\
\end{array}
\right)
\end{equation}

and covariance matrix

\begin{equation}
\left(
\begin{array}{cccc}
  0.0169 & 0.00468 & 0.001456 & 0.00832 \\
  0.00468 & 0.0081 & 0.001008 & 0.00576 \\
  0.001456 & 0.001008 & 0.000784 & 0.001792 \\
  0.00832 & 0.00576 & 0.001792 & 0.0256 \\
\end{array}
\right) .
\end{equation}

The `SimAlphaN` and `SimBetaN` functions from the `simStateSpace` package generates random intercept vectors and transition matrices from the multivariate normal distribution. Note that the `SimBetaN` function generates transition matrices that are weakly stationary.

Let the dynamic process noise $\boldsymbol{\Psi}$ be given by

\begin{equation}
\boldsymbol{\Psi}
=
\left(
\begin{array}{cc}
  1.3 & 0.5696315 \\
  0.5696315 & 1.56 \\
\end{array}
\right) .
\end{equation}



### R Function Arguments


``` r
n
#> [1] 100
time
#> [1] 1000
mu0
#> [[1]]
#> [1] 3.814355 2.576348
sigma0
#>           [,1]      [,2]
#> [1,] 1.3978842 0.5782369
#> [2,] 0.5782369 1.6636513
sigma0_l
#> [[1]]
#>           [,1]     [,2]
#> [1,] 1.1823215 0.000000
#> [2,] 0.4890691 1.193509
# first alpha in the list of length n
alpha[[1]]
#> [1] 0.8481424 2.1983711
# first beta in the list of length n
beta[[1]]
#>            [,1]       [,2]
#> [1,] 0.21090478 0.00660174
#> [2,] 0.01360809 0.37057228
psi
#>           [,1]      [,2]
#> [1,] 1.3000000 0.5696315
#> [2,] 0.5696315 1.5600000
psi_l
#> [[1]]
#>           [,1]     [,2]
#> [1,] 1.1401754 0.000000
#> [2,] 0.4995998 1.144727
nu
#> [[1]]
#> [1] 0 0
lambda
#> [[1]]
#>      [,1] [,2]
#> [1,]    1    0
#> [2,]    0    1
theta
#>      [,1] [,2]
#> [1,]  0.2  0.0
#> [2,]  0.0  0.2
```

### Visualizing the Dynamics Without Process Noise (n = 5 with Different Initial Condition)

<img src="fig-vignettes-fit-dt-var-id-mx-mixed-no-error-1.png" width="3300" /><img src="fig-vignettes-fit-dt-var-id-mx-mixed-no-error-2.png" width="3300" />

### Using the `SimSSMIVary` Function from the `simStateSpace` Package to Simulate Data


``` r
library(simStateSpace)
sim <- SimSSMIVary(
  n = n,
  time = time,
  mu0 = mu0,
  sigma0_l = sigma0_l,
  alpha = alpha,
  beta = beta,
  psi_l = psi_l,
  nu = nu,
  lambda = lambda,
  theta_l = theta_l
)
data <- as.data.frame(sim)
head(data)
#>   id time         y1       y2
#> 1  1    0  4.2923877 3.340872
#> 2  1    1  1.0083994 5.277654
#> 3  1    2  0.1329195 3.635821
#> 4  1    3 -0.5846274 3.113339
#> 5  1    4 -0.6400584 3.361309
#> 6  1    5  1.9021483 4.217966
plot(sim)
```

<img src="fig-vignettes-fit-dt-var-id-mx-mixed-error-1.png" width="3300" /><img src="fig-vignettes-fit-dt-var-id-mx-mixed-error-2.png" width="3300" />

## Model Fitting

The `DTVAR` function fits a DT-VAR model on each individual $i$ using the `byid = TRUE` argument.
The model type is specified using the `model` argument.




``` r
library(fitDTVARMx)
fit <- DTVAR(
  data = data,
  observed = paste0("y", seq_len(k)),
  id = "id",
  model = 5,
  byid = TRUE,
  ncores = parallel::detectCores()
)
fit
#>  paramaters per individual.
#>            beta_11      beta_21      beta_12     beta_22    alpha_1     alpha_2
#>   [1,] -0.85947202 -0.012039283  0.434889876  0.36735476 0.47422602  2.26866995
#>   [2,] -0.56931362  0.013647197  0.282539690  0.46303242 7.34815603  3.34370961
#>   [3,]  0.35629928  0.035702733 -0.038112320  0.37052714 2.28917684  0.43691307
#>   [4,]  0.23362144 -0.018121573 -0.111949908  0.64425424 3.81489295  1.86199367
#>   [5,]  0.25064788 -0.108838931 -0.063033957  0.33984009 3.72374445  3.11765158
#>   [6,] -0.36511967 -0.019155111  0.183874623  0.42571408 4.48652081  1.45360916
#>   [7,]  0.08039118 -0.017185343 -0.029697387  0.46285222 3.01127597  1.76674169
#>   [8,] -0.05513484 -0.283072525 -0.093020931  0.24247882 3.23487616  0.89031333
#>   [9,]  0.44748821 -0.044627969 -0.063223146  0.43703848 2.69334343  1.08140759
#>  [10,]  0.12109333 -0.317562695 -0.075898969  0.31548924 3.24493909  4.06570805
#>  [11,]  0.25645603 -0.055748428 -0.023033995  0.21344898 4.08297077  1.04835562
#>  [12,]  0.41733201  0.415840643  0.107619360 -0.48104553 1.72934818 -0.19458632
#>  [13,] -0.06441228  0.179028031  0.440803659  0.11551133 3.69070318  0.80122240
#>  [14,]  0.08115113 -0.110517861 -0.104601284  0.28607988 3.38149785  1.93052227
#>  [15,]  0.31767944 -0.189503573 -0.123261462  0.49286273 3.35619655  2.14194922
#>  [16,] -0.48744881 -0.084122585  0.187381706  0.37529271 5.24647407  1.94336808
#>  [17,] -1.15790596 -0.518976174  3.429764928  1.46844378 1.99327435  0.69380442
#>  [18,]  0.23868229  0.232738943  0.004730939 -0.53061437 4.02993146  1.83912831
#>  [19,]  0.48219831  0.341100159  0.030406105 -0.45312798 2.67847457  5.66479622
#>  [20,]  0.05642185 -0.504270929 -0.001201351  0.36356582 3.62402799  2.58862401
#>  [21,]  0.30501244 -0.063076132 -0.039522058  0.43654694 1.50648738  1.98509468
#>  [22,]  0.49663515 -0.011341655  0.011492240  0.73572742 5.03069879  3.83259337
#>  [23,]  0.30024289  0.102794060 -0.042459356  0.11650886 2.77325242  2.05366278
#>  [24,]  0.52891003  0.182397326 -0.009206871  0.37841175 4.22817897  3.67999519
#>  [25,] -0.40330082  0.009710887  0.202390908  0.39944792 1.54066345  1.13568443
#>  [26,]  0.48593872 -0.043068226 -0.022951677  0.45626082 1.86222070  3.23083865
#>  [27,]  0.39733900  0.079977389 -0.042259011  0.55021239 2.63427005  2.83678954
#>  [28,]  0.38339237  0.402545478  0.006469680 -0.46655997 4.04938382  2.63926523
#>  [29,]  0.52347332 -0.037825817 -0.004383104  0.32534299 2.83120308  0.01949861
#>  [30,]  0.32892122  0.054408189 -0.089147662  0.42650082 2.47404080  1.70545412
#>  [31,]  0.31886830 -0.081924995  0.062691420  0.30686921 3.01633783  0.58601487
#>  [32,]  0.32976219 -0.175525271 -0.117154957 -0.13163302 3.82597444  1.99809113
#>  [33,]  0.40719047 -0.163904346 -0.070585596  0.37051147 3.97997740  0.94956336
#>  [34,]  0.35362182  0.500190703 -0.283376925 -0.40782107 2.30272203 -0.15873322
#>  [35,]  0.44270710  0.068575578 -0.046388656  0.40877036 0.08393501  2.21669414
#>  [36,]  0.20586803 -0.193954824 -0.152547986  0.42200382 0.86945005  2.89045369
#>  [37,]  0.36800424 -0.073496524 -0.117703750  0.18003051 3.42102858  1.53849520
#>  [38,] -0.51445530  0.058118126  0.333726603  0.33928646 4.70655855  1.32357155
#>  [39,]  0.33624131 -0.014780858 -0.001962437  0.37077835 3.02349007  0.06453525
#>  [40,] -0.36576401  0.296468464  0.136779275  0.02236371 1.96303797  4.09338135
#>  [41,]  0.13507271 -0.086350179 -0.047291857  0.43210402 2.10504953  2.42209810
#>  [42,] -0.47628146 -0.035744870  0.203431610  0.32919445 2.90459446  2.27060941
#>  [43,]  0.41694732 -0.142837761 -0.135422514  0.40909447 1.14388258  0.83176140
#>  [44,]  0.26024309  0.158142281 -0.014289358 -0.51695114 4.79967348  2.54771566
#>  [45,]  0.20686903  0.027817284 -0.099460995  0.03424789 2.08529588  0.65942811
#>  [46,]  0.14458255 -0.144050063  0.062758651  0.01829476 2.18216042  0.99282445
#>  [47,]  0.17064202  0.135797403 -0.013721859 -0.22566595 3.68578442  4.77015096
#>  [48,] -0.54980850 -0.137886901  0.163030713  0.31883901 3.15976155  1.91647014
#>  [49,]  0.26181890 -0.160762025 -0.172230118  0.23762861 3.54742517  2.67789054
#>  [50,]  0.20283765 -0.101614488 -0.074407294  0.44687554 2.44842228  1.40261817
#>  [51,]  0.20941324 -0.164575202  0.093660426  0.47899626 3.05619201  2.95267870
#>  [52,]  0.26906304 -0.175799585 -0.077956536  0.31125898 3.31855210  3.67459206
#>  [53,]  0.23778521  0.157106732 -0.205129317 -0.42529102 2.78746935 -0.88967285
#>  [54,]  0.20543198  0.112256503  0.217610619 -0.25461847 3.72278759  2.93305382
#>  [55,]  0.27140851 -0.418553775 -0.052127066  0.15915746 4.80886191  1.51823421
#>  [56,]  0.22767886 -0.186896229 -0.073326246  0.16086751 2.81334350  1.99800047
#>  [57,]  0.26699908 -0.094400501 -0.095047442  0.23646179 2.55558516  0.16886990
#>  [58,]  0.04895543 -0.135522488 -0.057090267 -0.02406433 3.10262840  2.35105592
#>  [59,]  0.52141338 -0.061236821 -0.187748030  0.31109066 2.46541690  2.27016369
#>  [60,]  0.40837277  0.002049302 -0.612146775  0.04969259 2.90559017  2.26320190
#>  [61,]  0.26280168 -0.242125000 -0.220932798 -0.01742405 3.99100477  1.23917633
#>  [62,] -1.22385434 -0.428433623  3.600947552  1.29779934 2.68623267  1.19510843
#>  [63,]  0.14423558 -0.107973584 -0.063785576  0.44924603 2.86292699  2.79708801
#>  [64,]  0.12403212  0.004944022  0.001596223  0.48017765 2.30154955  1.52458097
#>  [65,]  0.15221021 -0.103237924  0.002062002  0.28108633 1.90461192  0.88427217
#>  [66,]  0.36025739 -0.071491220 -0.069815953  0.06123019 1.19973688  0.43059741
#>  [67,]  0.29769126 -0.092040783 -0.002074986  0.11617225 2.59956028  3.20675189
#>  [68,] -0.46356005 -0.058444988  0.248699985  0.46707428 2.63025033  3.05770249
#>  [69,]  0.51521112  0.545211591  0.146742453 -0.53882746 3.68972657  3.34557892
#>  [70,]  0.20110290 -0.273352840 -0.015699472  0.33552623 3.37524988  1.05737082
#>  [71,]  0.52483413  0.160524378 -0.070143617  0.48389218 3.01137576  2.02331387
#>  [72,]  0.18935165 -0.156446969 -0.110502489  0.13064781 2.95109510  2.52919137
#>  [73,]  0.38565327 -0.091260571 -0.082360314  0.19667246 3.50171575  2.49072303
#>  [74,]  0.59533254 -0.028476771 -0.021770115  0.18628999 4.65360280  2.77230254
#>  [75,]  0.35623221  0.145214837 -0.027240409  0.32077861 1.92207620  2.30369087
#>  [76,]  0.30065789 -0.134928753 -0.034415751  0.27208156 4.57108317  3.54159600
#>  [77,]  0.22991741 -0.127729914 -0.033033304  0.28816528 2.00865644  1.08914418
#>  [78,]  0.49501931  0.234990486 -0.097351169 -0.49981133 1.00319115  3.66930075
#>  [79,]  0.16572238 -0.044307158 -0.106232023  0.33940371 2.18065392  2.85135098
#>  [80,]  0.34965319 -0.094836951 -0.154184163  0.49443139 3.77111933  2.59856630
#>  [81,]  0.19810387 -0.115402910 -0.104751539  0.12968958 2.07929561  0.37680334
#>  [82,]  0.27017718 -0.131426504 -0.332525162 -0.05532521 2.99518600  2.21514012
#>  [83,]  0.51242722  0.038648253 -0.007383245  0.84373801 1.63439481  1.75965814
#>  [84,]  0.29900180 -0.069606071 -0.061749950 -0.02777781 1.74008370  1.21850224
#>  [85,]  0.13711310 -0.032408616  0.012832564  0.29046932 2.09622961  2.64809941
#>  [86,]  0.21593520 -0.029299385 -0.074454308  0.27494343 0.63514011  0.32578753
#>  [87,] -0.42817568  0.053253747  0.325345195  0.26760104 1.12695737  3.01999137
#>  [88,]  0.15591356 -0.420268517 -0.026449806  0.27918492 2.57524614  2.95913594
#>  [89,]  0.21839225 -0.312486017 -0.084933690  0.22713881 1.92508604  1.96045038
#>  [90,]  0.18169696 -0.080038269 -0.096445897  0.18411941 1.73758239  2.88642405
#>  [91,] -0.49483163  0.141867991  0.231870082  0.20100246 4.77862461  2.48574836
#>  [92,]  0.20822005 -0.420509520 -0.064791322  0.17309780 3.41848796  2.84927746
#>  [93,]  0.16750988  0.034628006 -0.081072830  0.23286861 3.02253406  2.61169778
#>  [94,]  0.43663021  0.379811956  0.122856565 -0.45647002 3.21722909  1.98818583
#>  [95,]  0.38815275  0.476292427 -0.007807346 -0.52508931 3.25226109  1.71101867
#>  [96,]  0.17529171 -0.147459557  0.022371694  0.09043369 2.89326134  1.63403995
#>  [97,]  0.26100465 -0.072521671 -0.026934798  0.47319918 2.36752548  0.66665955
#>  [98,]  0.26535530 -0.075956408 -0.056603361  0.15803546 2.33032786  1.35789841
#>  [99,]  0.17614036 -0.094232800 -0.085205252  0.23181216 3.14905471  1.16037917
#> [100,]  0.23964452 -0.146178092  0.010911675  0.09804725 4.33027294  3.33426115
#>               psi_11    psi_21        psi_22      theta_11      theta_22
#>   [1,]  1.534180e-01 0.5192412  1.561854e+00  1.443110e+00  1.633482e-01
#>   [2,]  1.109284e-15 0.5232570  1.763502e+00  1.635159e+00 2.225074e-308
#>   [3,]  7.741899e-01 0.5468848  1.531423e+00  6.266520e-01  2.556730e-01
#>   [4,]  1.447022e+00 0.5467411  1.368753e+00  7.579624e-02  2.362818e-01
#>   [5,]  1.011363e+00 0.6305238  1.748665e+00  5.075145e-01  2.641805e-17
#>   [6,]  2.145529e-17 0.6660325  1.678225e+00  1.570653e+00  1.063163e-01
#>   [7,]  1.406811e+00 0.5487183  8.900270e-01 2.225074e-308  7.055408e-01
#>   [8,]  1.541239e+00 0.5766485  1.055400e+00 2.225074e-308  6.741425e-01
#>   [9,]  1.179349e+00 0.6033275  1.263951e+00  3.907030e-01  4.577077e-01
#>  [10,]  8.347573e-01 0.5665074  1.530112e+00  5.671402e-01 2.225074e-308
#>  [11,]  1.528654e+00 0.5277816  1.615504e+00 2.225074e-308  1.025779e-01
#>  [12,]  1.328638e+00 0.5975770  2.642969e-20  1.663255e-01  2.042394e+00
#>  [13,]  3.680889e-18 0.5867378  3.942630e-01  1.565969e+00  1.337566e+00
#>  [14,]  1.594239e+00 0.5126010  1.047728e+00  2.098732e-17  5.342199e-01
#>  [15,]  1.278929e+00 0.5702379  2.953557e-01  2.188884e-01  1.307771e+00
#>  [16,]  1.228450e-18 0.5863629  1.807574e+00  1.514275e+00 2.225074e-308
#>  [17,]  1.739830e+00 0.6874664  2.537968e-01  1.929597e-17  1.654757e+00
#>  [18,]  1.567855e+00 0.6271089 2.225074e-308 2.225074e-308  1.928396e+00
#>  [19,]  1.218696e+00 0.6281732  1.337952e-16  3.506596e-01  1.972159e+00
#>  [20,]  4.534496e-01 0.5461178  1.573505e+00  1.037485e+00  5.392604e-33
#>  [21,]  1.331270e+00 0.4834306  1.485070e+00  2.012220e-01  1.078109e-01
#>  [22,]  1.227345e+00 0.6555069  1.738629e+00  2.071379e-01  1.610163e-01
#>  [23,]  1.645266e+00 0.6356734  1.769637e+00 2.225074e-308 2.225074e-308
#>  [24,]  1.150630e+00 0.5260285  1.427302e+00  2.995563e-01  2.677117e-01
#>  [25,] 2.225074e-308 0.6171610  1.216551e+00  1.627502e+00  5.957937e-01
#>  [26,]  7.115583e-01 0.5601364  1.323402e+00  7.315931e-01  3.956066e-01
#>  [27,]  1.481329e+00 0.4859776  1.383983e+00  4.107878e-17  2.491677e-01
#>  [28,]  1.210578e+00 0.5333778 2.225074e-308  2.307863e-01  1.911298e+00
#>  [29,]  9.490372e-01 0.4743996  1.532927e+00  4.372862e-01  1.599745e-01
#>  [30,]  1.263997e+00 0.5802375  1.361932e+00  1.851205e-01  5.168964e-01
#>  [31,]  1.209262e+00 0.4980185  1.142605e+00  1.854463e-01  6.373842e-01
#>  [32,]  1.131245e+00 0.5887400  1.329094e+00  3.169805e-01  4.085766e-01
#>  [33,]  7.135443e-01 0.5712682  1.072394e+00  6.678274e-01  5.611975e-01
#>  [34,]  3.787725e-03 0.7500181  1.582878e+00  1.575662e+00  2.656358e-01
#>  [35,]  1.315835e+00 0.5050339  1.384559e+00  3.262404e-01  2.581236e-01
#>  [36,]  1.539573e+00 0.5144555  7.797665e-01 2.225074e-308  8.505424e-01
#>  [37,]  6.039538e-01 0.5118832  1.787185e+00  8.446599e-01 2.225074e-308
#>  [38,]  1.177274e-17 0.5541911  1.454124e+00  1.746434e+00  3.773249e-01
#>  [39,]  1.236621e+00 0.5249093  1.361685e+00  3.225829e-01  3.096458e-01
#>  [40,] 2.225074e-308 0.6146516  1.867675e+00  1.638083e+00 2.225074e-308
#>  [41,]  1.481385e+00 0.5683683  1.729104e+00  1.746811e-17 2.225074e-308
#>  [42,]  2.888412e-16 0.6431477  1.889334e+00  1.557683e+00  3.654289e-16
#>  [43,]  1.539731e+00 0.5680510  1.075286e+00 2.225074e-308  5.306753e-01
#>  [44,]  1.481781e+00 0.5855602 2.225074e-308  2.711197e-16  1.892426e+00
#>  [45,]  1.375787e+00 0.4979665  1.730234e+00  2.753549e-18 2.225074e-308
#>  [46,]  1.519311e+00 0.5318764  3.911419e-17  1.971948e-22  1.733210e+00
#>  [47,]  1.338396e+00 0.6200961 2.225074e-308  1.576673e-01  1.764099e+00
#>  [48,] 2.225074e-308 0.5866686  1.769775e+00  1.548363e+00  1.191009e-16
#>  [49,]  1.111213e+00 0.5776334  1.599381e+00  3.671350e-01  1.451061e-01
#>  [50,]  5.276514e-01 0.5299679  1.711947e+00  8.200095e-01 2.225074e-308
#>  [51,]  1.507466e+00 0.5217900  1.140306e+00  8.301070e-17  6.223234e-01
#>  [52,]  1.579173e+00 0.5754444  9.116353e-01  9.645006e-19  7.617780e-01
#>  [53,]  1.505748e+00 0.6055787 2.225074e-308  8.517861e-10  1.794664e+00
#>  [54,]  1.512455e+00 0.5646697  6.518360e-17  1.997087e-17  1.835591e+00
#>  [55,]  8.307865e-01 0.6526764  1.752731e+00  7.414750e-01 2.225074e-308
#>  [56,]  1.192672e+00 0.4979633  1.704362e+00  2.603650e-01  2.865167e-03
#>  [57,]  1.312853e+00 0.5381003  1.762789e+00  1.650092e-01  9.192619e-18
#>  [58,]  1.505425e+00 0.5575640  1.709924e+00  2.780364e-20  2.416347e-20
#>  [59,]  1.330924e+00 0.5398654  1.114226e-17  1.676738e-01  1.842880e+00
#>  [60,]  1.437059e+00 0.6136597  4.111292e-01 2.225074e-308  1.286115e+00
#>  [61,]  1.117894e+00 0.5943774  8.097660e-01  3.666220e-01  9.444839e-01
#>  [62,]  1.830144e+00 0.6763006  2.144720e-01  8.839890e-18  1.511763e+00
#>  [63,]  1.508968e+00 0.5385719  8.564258e-01  8.256212e-18  8.015826e-01
#>  [64,]  1.447233e+00 0.5158323  1.193980e+00  1.746354e-17  4.815890e-01
#>  [65,]  1.580375e+00 0.5814324  1.226731e+00  4.889076e-02  5.560718e-01
#>  [66,]  1.327150e+00 0.5330168  1.691795e+00  2.142268e-01  2.465190e-32
#>  [67,]  1.493956e+00 0.6220944  1.789142e+00 2.225074e-308  7.321615e-30
#>  [68,] 2.225074e-308 0.7764666  1.973620e+00  1.701291e+00 2.225074e-308
#>  [69,]  9.881726e-01 0.4941456 2.225074e-308  4.909821e-01  2.077915e+00
#>  [70,]  1.392339e+00 0.5533862  1.755644e+00 2.225074e-308  3.699162e-03
#>  [71,]  1.361988e+00 0.6169998  1.453937e+00  2.187876e-01  2.778912e-01
#>  [72,]  1.562583e+00 0.6606053  9.057239e-01  9.783608e-19  8.219510e-01
#>  [73,]  1.001456e+00 0.4368840  1.707568e+00  4.209047e-01  2.317598e-18
#>  [74,]  1.378620e+00 0.5441458  1.479457e+00  1.409779e-01  2.108869e-01
#>  [75,]  1.333986e+00 0.5567779  1.747347e+00  9.969053e-02  4.640232e-02
#>  [76,]  1.516331e+00 0.5149256  1.852622e+00 2.225074e-308 2.225074e-308
#>  [77,]  1.586200e+00 0.6041382  1.379951e+00  1.274950e-18  4.049888e-01
#>  [78,]  1.655677e+00 0.6940802  1.993169e-15  1.504514e-15  1.993383e+00
#>  [79,]  1.119484e+00 0.6581339  1.204231e+00  3.614876e-01  5.460556e-01
#>  [80,]  1.319365e+00 0.5441213  9.911524e-01  1.720213e-01  7.425676e-01
#>  [81,]  1.516197e+00 0.5481506  1.697125e+00 2.225074e-308  5.335475e-18
#>  [82,]  1.473909e+00 0.5342306  5.122590e-01 2.225074e-308  1.257354e+00
#>  [83,]  1.320376e+00 0.5619187  1.328986e+00  1.290587e-01  3.671495e-01
#>  [84,]  1.130679e+00 0.6169321  1.764002e+00  3.229148e-01  8.620644e-17
#>  [85,]  1.511100e+00 0.5641618  1.657058e+00 2.225074e-308 2.225074e-308
#>  [86,]  1.544059e+00 0.6250222  1.518975e+00 2.225074e-308  3.027064e-01
#>  [87,] 2.225074e-308 0.5123161  7.900725e-01  1.645256e+00  8.810915e-01
#>  [88,]  9.586578e-01 0.6048904  1.746725e+00  5.573513e-01 2.225074e-308
#>  [89,]  9.519908e-01 0.6726958  1.830432e+00  5.589507e-01  4.010625e-18
#>  [90,]  1.571741e+00 0.6063614  1.770887e+00 2.225074e-308 2.225074e-308
#>  [91,] 2.225074e-308 0.5815962  1.702257e+00  1.695056e+00 2.225074e-308
#>  [92,]  1.167911e+00 0.5723045  1.720708e+00  3.332942e-01 2.225074e-308
#>  [93,]  1.639400e+00 0.7340346  1.916738e+00  1.459248e-16  2.224308e-17
#>  [94,]  1.114290e+00 0.5537678 2.225074e-308  3.678429e-01  1.952992e+00
#>  [95,]  9.026432e-01 0.5512027 2.225074e-308  4.790705e-01  2.085391e+00
#>  [96,]  1.604533e+00 0.6299923  1.712179e+00  2.738550e-16 2.225074e-308
#>  [97,]  1.203202e+00 0.4442784  1.148930e+00  1.853462e-01  4.965539e-01
#>  [98,]  1.517375e+00 0.5801312  1.738695e+00 2.225074e-308  1.962868e-17
#>  [99,]  1.577041e+00 0.6774147  9.999102e-01 2.225074e-308  7.117343e-01
#> [100,]  1.438777e+00 0.5523081  1.729334e+00  3.343966e-18 2.225074e-308
```

## Multivariate Meta-Analysis

The `MetaVARMx` function performs multivariate meta-analysis using the estimated parameters
and the corresponding sampling variance-covariance matrix for each individual $i$.
Estimates with the prefix `b0` correspond to the estimates of `beta_mu` and `alpha_mu`.
Estimates with the prefix `b1` correspond to the estimates of the effects of `x` on `y`. Note that the effects of `x` on `y` in this case are all zeros.
Estimates with the prefix `t2` correspond to the estimates of `beta_sigma` and `alpha_sigma`.
Estimates with the prefix `i2` correspond to the estimates of heterogeniety.


``` r
x <- lapply(
  X = seq_len(n),
  FUN = function(i) {
    stats::rnorm(n = 2)
  }
)
```


``` r
library(metaVAR)
meta <- MetaVARMx(
  object = fit,
  x = x,
  ncores = parallel::detectCores()
)
#> Running Model with 22 parameters
#> 
#> Beginning initial fit attempt
#> Running Model with 22 parameters
#> 
#>  Lowest minimum so far:  -230.321092311223
#> 
#> Solution found
```



```
#> 
#>  Solution found!  Final fit=-230.32109 (started at 780.28113)  (1 attempt(s): 1 valid, 0 errors)
#>  Start values from best fit:
#> 0.173591455930196,-0.0244531766551052,-0.0041342757386783,0.204674982666649,-0.0222491183553858,-0.00659586624112537,-0.00175346650109906,0.0251672020094128,-0.0569682353687557,0.00553202681557878,0.0206647434628365,-0.0242064592121756,0.268876146455432,0.0116842034561608,-0.0657820161444146,-0.0516283265345504,0.145679954638197,0.0494763825024717,-0.129332645775467,0.0387206979863157,0.0439824980761632,0.231729390531929
summary(meta)
#>            est     se       z      p    2.5%   97.5%
#> b0_1    0.1736 0.0289  6.0147 0.0000  0.1170  0.2302
#> b0_2   -0.0245 0.0176 -1.3906 0.1643 -0.0589  0.0100
#> b0_3   -0.0041 0.0116 -0.3561 0.7218 -0.0269  0.0186
#> b0_4    0.2047 0.0294  6.9651 0.0000  0.1471  0.2623
#> b1_11  -0.0222 0.0255 -0.8734 0.3824 -0.0722  0.0277
#> b1_21  -0.0066 0.0150 -0.4389 0.6607 -0.0360  0.0229
#> b1_31  -0.0018 0.0098 -0.1782 0.8586 -0.0210  0.0175
#> b1_41   0.0252 0.0260  0.9673 0.3334 -0.0258  0.0762
#> b1_12  -0.0570 0.0285 -1.9957 0.0460 -0.1129 -0.0010
#> b1_22   0.0055 0.0172  0.3216 0.7477 -0.0282  0.0392
#> b1_32   0.0207 0.0109  1.8904 0.0587 -0.0008  0.0421
#> b1_42  -0.0242 0.0290 -0.8341 0.4042 -0.0811  0.0327
#> t2_1_1  0.0723 0.0118  6.1374 0.0000  0.0492  0.0954
#> t2_2_1  0.0031 0.0058  0.5393 0.5897 -0.0083  0.0146
#> t2_3_1 -0.0177 0.0039 -4.5426 0.0000 -0.0253 -0.0101
#> t2_4_1 -0.0139 0.0081 -1.7043 0.0883 -0.0298  0.0021
#> t2_2_2  0.0214 0.0041  5.1830 0.0000  0.0133  0.0294
#> t2_3_2  0.0064 0.0027  2.4178 0.0156  0.0012  0.0117
#> t2_4_2 -0.0194 0.0054 -3.6179 0.0003 -0.0300 -0.0089
#> t2_3_3  0.0083 0.0018  4.4806 0.0000  0.0047  0.0119
#> t2_4_3 -0.0013 0.0038 -0.3402 0.7337 -0.0088  0.0062
#> t2_4_4  0.0750 0.0118  6.3346 0.0000  0.0518  0.0982
#> i2_1    0.9057 0.0139 65.0831 0.0000  0.8784  0.9330
#> i2_2    0.8264 0.0277 29.8662 0.0000  0.7722  0.8806
#> i2_3    0.7414 0.0428 17.3241 0.0000  0.6575  0.8253
#> i2_4    0.9243 0.0110 83.7271 0.0000  0.9027  0.9460
```

## References


